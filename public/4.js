webpackJsonp([4],{"+O4B":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mt-5 attendance-head"},[a("div",{staticClass:"mb-5 row align-items-center"},[a("div",{staticClass:"col-12 title-con"},[a("span",{staticClass:"title"},[t._v(t._s(t._f("capitalize")(t.title)))]),t._v(" "),t.to?a("div",{staticClass:"row justify-content-end"},[a("router-link",{staticClass:"text-link mt-3",attrs:{to:t.to}},[t._v(t._s(t.buttonTitle))])],1):t._e()])])])},staticRenderFns:[]}},"1gIg":function(t,e,a){var r=a("VU/8")(a("wBhk"),a("9sZT"),!1,null,null,null);t.exports=r.exports},"4I72":function(t,e,a){var r=a("VU/8")(a("WiSW"),a("bq6L"),!1,null,null,null);t.exports=r.exports},"9sZT":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h4",{staticClass:"mx-md-3 mx-0 py-0 my-0 text-center clearfix",attrs:{id:"app-navigation"}},[t.$routerHistory.hasPrevious()?a("router-link",{staticClass:"text-secondary float-left ml-1 pl-2 ml-sm-4 pl-sm-3",attrs:{to:t.previous,id:"back"}},[a("span",{staticClass:"mr-5 float-left"},[a("i",{staticClass:"far fa-arrow-alt-circle-left float-left"}),t._v(" "),a("small",{staticClass:"float-left ml-2 d-none d-sm-block"},[t._v("Back")])])]):t._e(),t._v(" "),a("strong",{staticClass:"mx-auto w-100 float-left",attrs:{"data-title":"title"}},[a("span",{staticClass:"d-none d-sm-block"},[t._v(t._s(t.pageTitle))]),t._v(" "),a("span",{staticClass:"d-block d-sm-none"},[t._v(t._s(t.pageTitleSmall))])]),t._v(" "),t.$routerHistory.hasForward()?a("router-link",{staticClass:"text-secondary float-right mr-1 pr-2 mr-sm-4 pr-sm-3",attrs:{to:t.forward,id:"forward"}},[a("span",{staticClass:"ml-5 float-right"},[a("i",{staticClass:"far fa-arrow-alt-circle-right float-right"}),t._v(" "),a("small",{staticClass:"float-right mr-2 d-none d-sm-block"},[t._v("Forward")])])]):t._e()],1)},staticRenderFns:[]}},EHiD:function(t,e,a){var r=a("reRT");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a("rjj0")("264e5ba7",r,!0,{})},EJ7O:function(t,e,a){var r=a("VU/8")(a("oKx2"),a("+O4B"),!1,null,null,null);t.exports=r.exports},HY2W:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=f(a("Xxa5")),n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},s=a("NYxO"),o=a("ic49"),i=f(a("KVer")),c=f(a("K23+")),l=a("m2tk"),u=a("p/p5"),d=a("rN6N"),m=f(a("EJ7O")),p=f(a("4I72"));function f(t){return t&&t.__esModule?t:{default:t}}function v(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function r(n,s){try{var o=e[n](s),i=o.value}catch(t){return void a(t)}if(!o.done)return Promise.resolve(i).then(function(t){r("next",t)},function(t){r("throw",t)});t(i)}("next")})}}e.default={components:{CustomHeader:m.default,CustomerProfile:p.default},data:function(){return{Order:d.Order,customer:null,customer_id:"",user:{name:i.default.state.user_name,id:i.default.state.user_id},show:!1,showModalContent:!1,activeOrder:null,headers:["Date","Order No.","Product Name","Total Product Price","Percentage","Down Payment","Repayment Plans"],paymentForm:null,canAddPayment:null,paymentFormType:"add"}},methods:{updateView:function(){var t=v(r.default.mark(function t(e){var a,n;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=e.customer,n=e.user,a.length?((a=a[0]).document.id||(a.document={id_card_url:"",passport_url:""}),this.user.branch=n.branch_id,this.customer=a,this.customer.orders=a.orders.map(function(t){return new d.Order(t,a)}),this.show=!0):c.default.setError("Customer not found.",5e3),this.$LIPS(!1);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),processForm:function(){var t=this;this.show=!1,this.$LIPS(!0),(0,u.get)("/api/customer/lookup/"+this.customer_id).then(function(e){return t.updateView(e.data)}).catch(function(){t.$LIPS(!1),c.default.setError("Error Fetching customer detail")})},displayAmortization:function(t){return this.activeOrder=this.customer.orders[t],this.canAddPayment=this.canUserAddPayment,this.paymentForm={payments:[]},this.showModalContent=!0,$("#amortization").modal("toggle")},addPaymentForm:function(t){var e=this.activeOrder.repaymentLevel,a=parseInt(e+this.paymentForm.payments.length+1);if(t!==this.paymentFormType&&(this.paymentForm.payments=[]),!("edit"===t&&(e<1||this.paymentForm.payments.length>=e)||e===this.activeOrder._count||a>this.activeOrder._count)){this.paymentFormType=t;var r={_pay:this.activeOrder.amountsToBePaid[0],_date:this.$getDate(),_col:"",column:""};"add"===t&&(r._payment_bank="",r._payment_method=""),this.paymentForm.payments.push(r),this.reNumber()}},deletePayment:function(t){this.paymentForm.payments.splice(t,1),this.reNumber()},reNumber:function(){var t=this;this.paymentForm.payments.forEach(function(e,a){var r=t.activeOrder.repaymentLevel+a+1;t.paymentForm.payments[a]._col=r,t.paymentForm.payments[a].column=t.$getColumn(r)+" Repayment"})},preparePayments:function(){var t=this;if(this.canAddPayment){var e={};this.paymentForm.payments.forEach(function(a){var r={},s=t.$getColumn(a._col);r[s+"_pay"]=a._pay,r[s+"_date"]=a._date,"add"===t.paymentFormType&&(r[s+"_payment_bank"]=a._payment_bank,r[s+"_payment_method"]=a._payment_method),e=n({},e,r)}),this.activeOrder.payments=e,$.isEmptyObject(e)?c.default.setError("You have not added any payment."):this.savePayments()}},savePayments:function(){var t=this;if(this.canAddPayment){this.$LIPS(!0);var e,a,n=void 0,s=void 0,o=void 0;6===this.activeOrder.count&&(n="formal"),12===this.activeOrder.count&&(n="informal"),e={payments:this.activeOrder.payments,repayment_id:this.activeOrder.order.id,type:n},(0,u.post)("/api/repayment",e).then((a=v(r.default.mark(function a(i){return r.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!i.data.saved){a.next=13;break}return(s=t.customer.orders.find(function(t,a){var r=t.order.id===e.repayment_id;return r&&(o=a),r}).order)["repayment_"+n]=i.data.amortization,a.next=5,new d.Order(s,t.customer);case 5:return t.activeOrder=a.sent,t.customer.orders[o]=t.activeOrder,a.next=9,t.logAddedPayment(e);case 9:t.activeOrder.repaymentLevel===t.activeOrder.count&&t.sendPaymentCompleteSMS(),t.paymentForm={payments:[]},t.$scrollToTop(),t.$LIPS(!1);case 13:case"end":return a.stop()}},a,t)})),function(t){return a.apply(this,arguments)})).catch(function(){return c.default.setError("Error adding payment! Please try again later.")})}},sendPaymentCompleteSMS:function(){var t="Dear "+this.activeOrder.customerName+", you have successfully completed your payment for "+this.activeOrder.order.store_product.product_name+". Thanks for patronizing us.";new l.Message(t,this.activeOrder.customer.telephone).send(function(t){return 200===t.status&&c.default.setSuccess("Repayments Completed. SMS sent.")})},logAddedPayment:function(t){var e=this.paymentForm.payments.map(function(t){return t.column.replace(/ /g,"_")}).join(" ")+". Order: ID: "+t.repayment_id+". Customer ID: "+this.customer_id;return(0,o.log)("Payment(s) added",e)}},computed:n({},(0,s.mapGetters)(["getBanks","getPaymentMethods","auth"]),{check:function(){return!(!this.$isProcessing&&this.customer_id)},canUserAddPayment:function(){return!!this.auth("FSLLead")||this.auth("supervisor")&&this.user.branch===this.activeOrder.branch.id}}),created:function(){this.$prepareBanks(),this.$prepareBranches(),this.$preparePaymentMethods()}}},JqtT:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"position-relative d-flex align-items-stretch"},[a("router-link",{class:t.buttonClass+" text-uppercase",attrs:{tag:t.link?"a":"span",to:t.link&&t.auth("DVAAccess")?t.link:"","data-function":"display"}},[t._v("\n        "+t._s(t.status.split("-").join(" "))+"\n        "),a("i",{class:"ml-3 fas fa-"+(t.isApproved?"check":"times")})]),t._v(" "),a("span",{class:t.buttonClass+" dropdown-toggle dropdown-toggle-split d-flex align-items-center",attrs:{"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}}),t._v(" "),a("div",{staticClass:"dropdown-menu"},t._l(t.options,function(e){return t.auth(e.authAccess)?a("a",{staticClass:"dropdown-item",attrs:{href:"javascript:"},on:{click:function(a){t.toggleModal(e.modal)}}},[t._v("\n            "+t._s(e.caption)+"\n        ")]):t._e()}))],1)},staticRenderFns:[]}},N9TL:function(t,e,a){var r=a("VU/8")(a("HY2W"),a("ZKDi"),!1,function(t){a("EHiD")},"data-v-79933b66",null);t.exports=r.exports},Or4O:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},n=a("NYxO"),s=a("nv24");e.default={props:["link","size","isApproved","customerName"],data:function(){return{status:null,options:[{caption:"Change sales agent",modal:"toggleChangeCustomerManagerModal",authAccess:"DSACaptain"},{caption:"Send message",modal:"SMSModal",authAccess:"DVAAccess"}]}},methods:{toggleModal:function(t){var e={customerId:this.$vnode.key,customerName:this.customerName};s.EventBus.$emit(t,e)}},computed:r({},(0,n.mapGetters)(["auth"]),{buttonClass:function(){return this.size&&(this.link?"status status-sm "+this.status:"status mt-md-5 my-sm-2 mt-0 "+this.status)}}),created:function(){this.status=this.isApproved?"approved":"not-approved"}}},SldL:function(t,e){!function(e){"use strict";var a,r=Object.prototype,n=r.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",i=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag",l="object"==typeof t,u=e.regeneratorRuntime;if(u)l&&(t.exports=u);else{(u=e.regeneratorRuntime=l?t.exports:{}).wrap=C;var d="suspendedStart",m="suspendedYield",p="executing",f="completed",v={},h={};h[o]=function(){return this};var _=Object.getPrototypeOf,y=_&&_(_($([])));y&&y!==r&&n.call(y,o)&&(h=y);var g=k.prototype=x.prototype=Object.create(h);w.prototype=g.constructor=k,k.constructor=w,k[c]=w.displayName="GeneratorFunction",u.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},u.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,k):(t.__proto__=k,c in t||(t[c]="GeneratorFunction")),t.prototype=Object.create(g),t},u.awrap=function(t){return{__await:t}},P(O.prototype),O.prototype[i]=function(){return this},u.AsyncIterator=O,u.async=function(t,e,a,r){var n=new O(C(t,e,a,r));return u.isGeneratorFunction(e)?n:n.next().then(function(t){return t.done?t.value:n.next()})},P(g),g[c]="Generator",g[o]=function(){return this},g.toString=function(){return"[object Generator]"},u.keys=function(t){var e=[];for(var a in t)e.push(a);return e.reverse(),function a(){for(;e.length;){var r=e.pop();if(r in t)return a.value=r,a.done=!1,a}return a.done=!0,a}},u.values=$,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=a,this.done=!1,this.delegate=null,this.method="next",this.arg=a,this.tryEntries.forEach(F),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=a)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=a),!!n}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],i=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,v):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.finallyLoc===t)return this.complete(a.completion,a.afterLoc),F(a),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.tryLoc===t){var r=a.completion;if("throw"===r.type){var n=r.arg;F(a)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:$(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=a),v}}}function C(t,e,a,r){var n=e&&e.prototype instanceof x?e:x,s=Object.create(n.prototype),o=new A(r||[]);return s._invoke=function(t,e,a){var r=d;return function(n,s){if(r===p)throw new Error("Generator is already running");if(r===f){if("throw"===n)throw s;return T()}for(a.method=n,a.arg=s;;){var o=a.delegate;if(o){var i=D(o,a);if(i){if(i===v)continue;return i}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(r===d)throw r=f,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r=p;var c=b(t,e,a);if("normal"===c.type){if(r=a.done?f:m,c.arg===v)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(r=f,a.method="throw",a.arg=c.arg)}}}(t,a,o),s}function b(t,e,a){try{return{type:"normal",arg:t.call(e,a)}}catch(t){return{type:"throw",arg:t}}}function x(){}function w(){}function k(){}function P(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function O(t){var e;this._invoke=function(a,r){function s(){return new Promise(function(e,s){!function e(a,r,s,o){var i=b(t[a],t,r);if("throw"!==i.type){var c=i.arg,l=c.value;return l&&"object"==typeof l&&n.call(l,"__await")?Promise.resolve(l.__await).then(function(t){e("next",t,s,o)},function(t){e("throw",t,s,o)}):Promise.resolve(l).then(function(t){c.value=t,s(c)},o)}o(i.arg)}(a,r,e,s)})}return e=e?e.then(s,s):s()}}function D(t,e){var r=t.iterator[e.method];if(r===a){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=a,D(t,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var n=b(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,v;var s=n.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=a),e.delegate=null,v):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function F(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function $(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,s=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=a,e.done=!0,e};return s.next=s}}return{next:T}}function T(){return{value:a,done:!0}}}(function(){return this}()||Function("return this")())},WiSW:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},n=l(a("I3G/")),s=a("NYxO"),o=(a("N71M"),a("nv24")),i=l(a("1gIg")),c=l(a("vRKz"));function l(t){return t&&t.__esModule?t:{default:t}}e.default={props:["viewCustomer"],components:{ApprovalStatusButton:c.default,AppNavigation:i.default},data:function(){return{customer:"",show:!1}},computed:{full:function(){return"full"===this.$route.meta.mode},passport:function(){return"https://s3.eu-west-2.amazonaws.com/altara-one/"+this.customer.document.passport_url},branch:function(){return this.customer.branch.description+" "+this.customer.branch.name},approved:function(){return this.$getCustomerApprovalStatus(this.customer.verification)}},created:function(){var t=this;$(".tooltip").remove(),this.viewCustomer&&this.setCustomer(this.viewCustomer),o.EventBus.$on("customer",function(e){return t.setCustomer(e)}),this.addCustomerOptionsModalsToDom()},methods:r({setCustomer:function(t){n.default.set(this.$data,"customer",t),this.show=!0}},(0,s.mapActions)("ModalAccess",["addCustomerOptionsModalsToDom","removeCustomerOptionsModalsFromDom"])),destroyed:function(){this.removeCustomerOptionsModalsFromDom()}}},Xxa5:function(t,e,a){t.exports=a("jyFz")},ZKDi:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"fade"}},[a("div",{attrs:{id:"reminder"}},[a("div",{staticClass:"mt-5 attendance-head"},[a("div",{staticClass:"card"},[a("ul",{staticClass:"nav nav-tabs bg-default justify-content-center"},[a("h6",[t._v("Customer Lookup")])]),t._v(" "),a("div",{staticClass:"card-body p-4"},[a("form",{on:{submit:function(e){return e.preventDefault(),t.processForm(e)}}},[a("div",{staticClass:"m-0 p-0 col-12 form-group clearfix"},[a("label",{staticClass:"w-100"},[t._v("Customer ID")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.customer_id,expression:"customer_id"},{name:"validate",rawName:"v-validate",value:"required|numeric",expression:"'required|numeric'"}],staticClass:"form-control col-lg-9 col-md-8 col-sm-8 col-12 float-left mt-1",attrs:{"data-vv-as":"customer id",name:"customer_id"},domProps:{value:t.customer_id},on:{onkeyUp:t.check,input:function(e){e.target.composing||(t.customer_id=e.target.value)}}}),t._v(" "),a("div",{staticClass:"col-lg-3 col-md-4 col-sm-4 col-12 float-right px-md-3 mt-md-0 px-sm-3 mt-sm-0 mt-2 px-0"},[a("button",{staticClass:"btn btn-block bg-default my-1",attrs:{disabled:t.check,type:"submit"}},[t._v("\n                                    Fetch customer details "),a("i",{staticClass:"far fa-paper-plane ml-1"})])]),t._v(" "),t.errors.has("customer_id")?a("small",{staticClass:"form-text text-muted w-100"},[t._v("\n                                "+t._s(t.errors.first("customer_id"))+"\n                            ")]):t._e()])])])])]),t._v(" "),a("transition",{attrs:{name:"fade"}},[t.customer&&t.show?a("div",[a("div",{staticClass:"attendance-head"},[a("customer-profile",{attrs:{"view-customer":t.customer}})],1),t._v(" "),a("custom-header",{attrs:{title:"All order(s)"}}),t._v(" "),a("div",{staticClass:"mt-5 mb-3 attendance-head"},[a("div",{staticClass:"row px-4 pt-3 pb-4 text-center"},[a("div",{staticClass:"col light-heading",staticStyle:{"max-width":"100px"}},[t._v("S/No.")]),t._v(" "),t._l(t.headers,function(e){return a("div",{staticClass:"col light-heading"},[t._v(t._s(e))])})],2)]),t._v(" "),a("div",{staticClass:"tab-content mt-1 attendance-body"},[t.show&&t.customer.orders.length>0?a("div",{staticClass:"tab-pane active text-center"},t._l(t.customer.orders,function(e,r){return a("div",{staticClass:"mb-3 row attendance-item"},[a("div",{staticClass:"col-12 col-xs-2 col-md col-lg d-flex align-items-center",staticStyle:{"max-width":"100px"}},[a("span",{staticClass:"user mx-auto"},[t._v(t._s(r+1))])]),t._v(" "),a("div",{staticClass:"col-12 col-xs-2 col-md col-lg d-flex align-items-center justify-content-center"},[t._v("\n                                "+t._s(e.order.order_date)+"\n                            ")]),t._v(" "),a("div",{staticClass:"col-12 col-xs-2 col-md col-lg d-flex user-name align-items-center justify-content-center"},[t._v("\n                                "+t._s(e.order.id)+"\n                            ")]),t._v(" "),a("div",{staticClass:"col-12 col-xs-3 col-md col-lg d-flex align-items-center justify-content-center"},[t._v("\n                                "+t._s(e.order.store_product.product_name)+"\n                            ")]),t._v(" "),a("div",{staticClass:"col-12 col-xs-2 col-md col-lg d-flex align-items-center justify-content-center"},[t._v("\n                                "+t._s(t.$formatCurrency(e.order.product_price))+"\n                            ")]),t._v(" "),a("div",{staticClass:"col-12 col-xs-2 col-md col-lg d-flex align-items-center justify-content-center"},[t._v("\n                                "+t._s(e.order.sales_category.name)+"\n                            ")]),t._v(" "),a("div",{staticClass:"col-12 col-xs-2 col-md col-lg d-flex align-items-center justify-content-center"},[t._v("\n                                "+t._s(t.$formatCurrency(e.order.down_payment))+"\n                            ")]),t._v(" "),a("div",{staticClass:"col-12 col-xs-2 col-md col-lg d-flex align-items-center justify-content-center"},[a("button",{staticClass:"btn status my-sm-2",class:e.count===e.repaymentLevel?"approved":"pending",on:{click:function(e){t.displayAmortization(r)}}},[t._v("\n                                    View Plan\n                                    "),a("i",{staticClass:"fas ml-3",class:e.count===e.repaymentLevel?"fa-check-circle":"fa-hourglass-half",staticStyle:{"font-size":"1.4rem"}})])])])})):a("div",{staticClass:"tab-pane active text-center"},[a("div",{staticClass:"mb-3 row attendance-item"},[a("div",{staticClass:"col d-flex light-heading align-items-center justify-content-center"},[t._v("\n                                No records found!\n                            ")])])])]),t._v(" "),a("div",{staticClass:"mt-5 mb-3 attendance-head"},[a("div",{staticClass:"w-100 my-5 mx-0 hr"})])],1):t._e()]),t._v(" "),a("div",{staticClass:"modal fade repayment",attrs:{id:"amortization"}},[a("div",{staticClass:"modal-dialog modal-xl",attrs:{role:"document"}},[t.showModalContent?a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header py-2"},[a("h6",{staticClass:"modal-title py-1"},[t._v("\n                            Repayment Plan/Summary - "+t._s(t._f("capitalize")(t.customer.employment_status))+"\n                        ")]),t._v(" "),a("a",{staticClass:"close py-1",attrs:{"aria-label":"Close","data-dismiss":"modal"}},[a("span",{staticClass:"modal-close text-danger",attrs:{"aria-hidden":"true"}},[a("i",{staticClass:"fas fa-times"})])])]),t._v(" "),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"table-responsive"},[a("h5",{staticClass:"mt-3 mb-0"},[t._v("Order Information")]),t._v(" "),a("table",{staticClass:"table table-bordered"},[a("tbody",[a("tr",{staticClass:"table-separator"},[a("td",[t._v("Name")]),t._v(" "),a("td",[t._v("Order Id")]),t._v(" "),a("td",[t._v("Product")]),t._v(" "),a("th",[t._v("Branch")]),t._v(" "),a("th",[t._v("Status")])]),t._v(" "),a("tr",[a("td",{staticClass:"font-weight-bold"},[t._v(t._s(t.activeOrder.customerName)+"\n                                    ")]),t._v(" "),a("th",[t._v(t._s(t.activeOrder.order.id))]),t._v(" "),a("th",[t._v(t._s(t.activeOrder.order.store_product.product_name))]),t._v(" "),a("td",[t._v(t._s(t.activeOrder.branch.name))]),t._v(" "),a("td",{staticClass:"font-weight-bold",class:"ok"===t.activeOrder.order.status.name.toLocaleString()?"paid":"missed"},[t._v("\n                                        "+t._s(t.activeOrder.order.status.name)+"\n                                    ")])])])]),t._v(" "),a("h5",{staticClass:"mt-5 mb-0"},[t._v("Amortization Schedule")]),t._v(" "),a("table",{staticClass:"table table-bordered"},[a("tbody",{staticClass:"text-center"},[a("tr",[a("th",[t._v("Repayment")]),t._v(" "),t._l(t.activeOrder.repaymentCaptions,function(e){return a("td",{domProps:{innerHTML:t._s(e)}})})],2),t._v(" "),a("tr",{staticClass:"table-separator"},[a("th",[t._v("Due Date")]),t._v(" "),t._l(t.activeOrder.dueDates,function(e){return a("td",[t._v(t._s(e))])})],2),t._v(" "),a("tr",[a("th",[t._v("Actual Pay Day")]),t._v(" "),t._l(t.activeOrder.actualPayDates,function(e){return a("td",[t._v(t._s(e))])})],2),t._v(" "),a("tr",{staticClass:"table-separator"},[a("th",[t._v("Status")]),t._v(" "),t._l(t.activeOrder.paymentStatusClasses,function(t){return a("td",{class:t.class},[a("i",{staticClass:"fas",class:t.icon})])})],2),t._v(" "),a("tr",{staticClass:"table-separator"},[a("th",[t._v("Repayment Amount")]),t._v(" "),t._l(t.activeOrder.amountsToBePaid,function(e){return a("td",[t._v("\n                                        "+t._s(t.$formatCurrency(e))+"\n                                    ")])})],2),t._v(" "),a("tr",[a("th",[t._v("Actual Amount Paid")]),t._v(" "),t._l(t.activeOrder.actualAmountsPaid,function(e){return a("td",[t._v("\n                                        "+t._s(t.$formatCurrency(e))+"\n                                    ")])})],2),t._v(" "),a("tr",{staticClass:"table-separator"},[a("th",[t._v("Payment Method")]),t._v(" "),t._l(t.activeOrder.paymentMethods,function(e){return a("td",{staticClass:"text-capitalize"},[t._v("\n                                        "+t._s(t.Order.convertToName(e,"paymentMethods"))+"\n                                    ")])})],2),t._v(" "),a("tr",[a("th",[t._v("Bank")]),t._v(" "),t._l(t.activeOrder.paymentBanks,function(e){return a("td",{staticClass:"text-capitalize"},[t._v("\n                                        "+t._s(t.Order.convertToName(e,"banks"))+"\n                                    ")])})],2)])]),t._v(" "),a("h5",{staticClass:"mt-5 mb-0"},[t._v("Payment Summary")]),t._v(" "),a("table",{staticClass:"table table-bordered"},[a("tbody",{staticClass:"text-center"},[a("tr",{staticClass:"table-separator"},[a("td",{staticClass:"text-left"},[t._v("Discount Detail (%)")]),t._v(" "),a("th",[t._v(t._s(t._f("capitalize")(t.activeOrder.discount)))]),t._v(" "),a("td",[t._v("Total Before Discount")]),t._v(" "),a("th",[t._v(t._s(t.$formatCurrency(t.$roundDownAmt(t.activeOrder.order.product_price))))]),t._v(" "),a("td",[t._v("Total Paid (+discount)")]),t._v(" "),a("th",[t._v(t._s(t.activeOrder.amountPaid))])]),t._v(" "),a("tr",[a("td",{staticClass:"text-left"},[t._v("Discount Amount")]),t._v(" "),a("th",[t._v(t._s(t.activeOrder.discountAmount))]),t._v(" "),a("td",[t._v("Total After Discount")]),t._v(" "),a("th",[t._v(t._s(t.activeOrder.discountedTotal))]),t._v(" "),a("td",[t._v("Total Debt")]),t._v(" "),a("th",[t._v(t._s(t.activeOrder.outstandingDebt))])]),t._v(" "),a("tr",[a("td",{staticClass:"text-left"},[t._v("Down Payment")]),t._v(" "),a("th",[t._v(t._s(t.$formatCurrency(t.$roundDownAmt(t.activeOrder.order.down_payment))))]),t._v(" "),a("td",[t._v("Total Plus Default Fee")]),t._v(" "),a("th",[t._v(t._s(t.activeOrder.totalPlusDefault))]),t._v(" "),a("td",[t._v("Default Fee")]),t._v(" "),a("th",[t._v(t._s(t.activeOrder.defaultFee))])])])]),t._v(" "),t.canAddPayment?a("h5",{staticClass:"mt-5 mb-0"},[t._v(t._s(t._f("capitalize")(t.paymentFormType))+" a new\n                                payment")]):t._e(),t._v(" "),t.canAddPayment?a("table",{staticClass:"table table-bordered"},[a("tbody",{staticClass:"text-center"},[a("tr",{staticClass:"table-separator"},[a("td",{staticClass:"text-left"},[t._v("S/No.")]),t._v(" "),a("th",[t._v("Repayment")]),t._v(" "),a("th",[t._v("Amount")]),t._v(" "),a("th",[t._v("Payment Method")]),t._v(" "),a("th",[t._v("Bank")]),t._v(" "),a("th",[t._v("Date")]),t._v(" "),a("th",[t._v("Collected By")]),t._v(" "),a("th",[t._v("Action")])]),t._v(" "),t._l(t.paymentForm.payments,function(e,r){return a("tr",[a("th",[t._v(t._s(r+1))]),t._v(" "),a("th",["add"===t.paymentFormType?a("div",{staticClass:"form-group mb-0"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.paymentForm.payments[r].column,expression:"paymentForm.payments[index].column"}],staticClass:"form-control",attrs:{name:"date",type:"text",disabled:""},domProps:{value:t.paymentForm.payments[r].column},on:{input:function(e){e.target.composing||t.$set(t.paymentForm.payments[r],"column",e.target.value)}}})]):a("select",{directives:[{name:"model",rawName:"v-model",value:t.paymentForm.payments[r]._col,expression:"paymentForm.payments[index]._col"}],staticClass:"custom-select w-100",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.paymentForm.payments[r],"_col",e.target.multiple?a:a[0])}}},t._l(t.activeOrder.repaymentLevel,function(e){return a("option",{domProps:{value:e}},[t._v("\n                                                "+t._s(t.$getColumn(e))+" Repayment\n                                            ")])}))]),t._v(" "),a("th",[a("div",{staticClass:"form-group mb-0"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.paymentForm.payments[r]._pay,expression:"paymentForm.payments[index]._pay"}],staticClass:"form-control",attrs:{name:"date",type:"text"},domProps:{value:t.paymentForm.payments[r]._pay},on:{input:function(e){e.target.composing||t.$set(t.paymentForm.payments[r],"_pay",e.target.value)}}})])]),t._v(" "),a("th",[a("select",{directives:[{name:"model",rawName:"v-model",value:t.paymentForm.payments[r]._payment_method,expression:"paymentForm.payments[index]._payment_method"}],staticClass:"custom-select w-100",attrs:{disabled:"edit"===t.paymentFormType},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.paymentForm.payments[r],"_payment_method",e.target.multiple?a:a[0])}}},t._l(t.getPaymentMethods,function(e){var r=e.name,n=e.id;return a("option",{domProps:{value:n}},[t._v("\n                                                "+t._s(t._f("capitalize")(r))+"\n                                            ")])}))]),t._v(" "),a("th",[a("select",{directives:[{name:"model",rawName:"v-model",value:t.paymentForm.payments[r]._payment_bank,expression:"paymentForm.payments[index]._payment_bank"}],staticClass:"custom-select w-100",attrs:{disabled:"edit"===t.paymentFormType},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.paymentForm.payments[r],"_payment_bank",e.target.multiple?a:a[0])}}},t._l(t.getBanks,function(e){var r=e.name,n=e.id;return a("option",{domProps:{value:n}},[t._v(t._s(r))])}))]),t._v(" "),a("th",[a("div",{staticClass:"form-group mb-0"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.paymentForm.payments[r]._date,expression:"paymentForm.payments[index]._date"}],staticClass:"form-control",attrs:{name:"date",type:"date"},domProps:{value:t.paymentForm.payments[r]._date},on:{input:function(e){e.target.composing||t.$set(t.paymentForm.payments[r],"_date",e.target.value)}}})])]),t._v(" "),a("th",[a("div",{staticClass:"form-group mb-0"},[a("input",{staticClass:"form-control",attrs:{"data-vv-as":"date",name:"date",type:"text",disabled:""},domProps:{value:t.user.name}})])]),t._v(" "),a("th",[a("button",{staticClass:"ml-2 btn status status-sm my-sm-2 not-approved",on:{click:function(e){t.deletePayment(r)}}},[a("i",{staticClass:"fas fa-times"})])])])})],2)]):t._e()])]),t._v(" "),a("div",{staticClass:"modal-footer",class:{"d-flex justify-content-end":!t.canAddPayment}},[t.canAddPayment?a("button",{staticClass:"btn status my-sm-2",on:{click:function(e){t.addPaymentForm("add")}}},[t._v("\n                            Add Payment\n                        ")]):t._e(),t._v(" "),t.auth("DSALead")?a("button",{staticClass:"btn status my-sm-2",on:{click:function(e){t.addPaymentForm("edit")}}},[t._v("\n                            Edit Payment\n                        ")]):t._e(),t._v(" "),t.canAddPayment?a("button",{staticClass:"btn status my-sm-2 approved ml-4",on:{click:function(e){t.preparePayments()}}},[t._v("\n                            Click here to Submit Payment(s)!\n                        ")]):t._e(),t._v(" "),a("a",{staticClass:"text-link mt-3",staticStyle:{"text-align":"right"},attrs:{"data-dismiss":"modal",href:"javascript:"}},[t._v("close dialogue")])])]):t._e()])])],1)])},staticRenderFns:[]}},bq6L:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"fade"}},[a("div",{class:t.full&&"px-md-4 px-2"},[t.full?a("app-navigation",{attrs:{forward:{path:t.$routerHistory.next().path},previous:{path:t.$routerHistory.previous().path},pageTitle:"Customer Profile",pageTitleSmall:"Customer Profile"}}):t._e(),t._v(" "),t.show?a("div",{staticClass:"pt-md-3 pt-2 verification",attrs:{id:"employeeRegister"}},[a("div",{staticClass:"customer-profile card position-relative"},[a("div",{staticClass:"design"}),t._v(" "),a("div",{staticClass:"col-md-4 col-sm-4 col-12 px-0 pb-md-4 pb-sm-3 pb-0 pt-md-5 pt-4 float-left"},[a("div",{staticClass:"pt-md-3 pt-sm-2 pt-1"},[a("div",{staticClass:"justify-content-center d-flex position-relative z-1"},[a("span",{staticClass:"img-border"},[t.customer.document.passport_url?a("img",{staticClass:"profile-picture rounded-circle",attrs:{src:t.passport,alt:"customer profile pic"}}):a("i",{staticClass:"no-image fas fa-user-alt"})])]),t._v(" "),a("div",{staticClass:"justify-content-center d-flex position-relative z-1 pt-md-4 pt-sm-4 pt-2"},[a("span",{staticClass:"w-50"},[a("div",{staticClass:"text-right px-4 py-3 text-light text-muted m-0"},[t._v("\n                                    Status"),a("i",{staticClass:"ml-3 fas fa-briefcase"})]),t._v(" "),a("div",{staticClass:"data text-right px-4 py-3 m-0"},[t._v(t._s(t._f("capitalize")(t.customer.employment_status)))])]),t._v(" "),a("span",{staticClass:"separator"}),t._v(" "),a("span",{staticClass:"w-50"},[a("div",{staticClass:"px-4 py-3 text-muted text-light m-0"},[a("i",{staticClass:"mr-3 fas fa-transgender"}),t._v("Gender\n                                ")]),t._v(" "),a("div",{staticClass:"data px-4 py-3 m-0"},[t._v(t._s(t._f("capitalize")(t.customer.gender)))])])])])]),t._v(" "),a("div",{staticClass:"col-md-8 col-sm-8 col-12 px-0 pb-4 pt-md-5 pt-sm-5 pt-0 float-left"},[a("div",{staticClass:"pt-md-4 pt-0 clearfix"},[a("div",{staticClass:"float-left p-0 m-0 col-md-4 col-sm-6 small-center"},[a("h4",{staticClass:"mt-0 pt-md-5 pt-sm-4 pt-0 mb-md-5 mb-sm-4 mb-3"},[a("i",{staticClass:"mr-3 far fa-user-circle"}),t._v(" "),a("strong",[t._v(t._s(t._f("capitalize")(t.$getCustomerFullName(t.customer))))])])]),t._v(" "),a("div",{staticClass:"float-left p-0 m-0 col-md-4 col-sm-6 d-flex justify-content-center"},[a("h4",{staticClass:"mt-0 pt-md-5 pt-sm-4 pt-0 mb-md-5 mb-sm-4 mb-4 text-muted"},[a("strong",[t._v("Customer ID: "+t._s(t.customer.id))])])]),t._v(" "),a("div",{staticClass:"float-left p-0 m-0 col-md-4 col-12 d-flex justify-content-center"},[a("ApprovalStatusButton",{key:t.customer.id,attrs:{size:"big","customer-name":t.$getCustomerFullName(t.customer),"is-approved":t.approved}})],1)]),t._v(" "),a("div",{staticClass:"pt-4"},[a("table",{staticClass:"table"},[a("tbody",[a("tr",[a("th",{staticClass:"text-muted"},[a("i",{staticClass:"mr-3 fas fa-mobile-alt"}),t._v("Phone Number")]),t._v(" "),a("td",[t._v(t._s(t.customer.telephone))])]),t._v(" "),t.$store.getters.auth("DVAAccess")?a("tr",[a("th",{staticClass:"text-muted"},[a("i",{staticClass:"mr-3 fas fa-map-marker-alt"}),t._v("Address")]),t._v(" "),a("td",[t._v(t._s(t._f("capitalize")(t.$getCustomerAddress(t.customer)))+"\n                                ")])]):t._e(),t._v(" "),a("tr",[a("th",{staticClass:"text-muted"},[a("i",{staticClass:"mr-3 fas fa-gift"}),t._v("Registered On")]),t._v(" "),a("td",[t._v(t._s(t.customer.date_of_registration))])]),t._v(" "),a("tr",[a("th",{staticClass:"text-muted"},[a("i",{staticClass:"mr-3 far fa-user-circle"}),t._v("Registered By")]),t._v(" "),a("td",[t._v(t._s(t._f("capitalize")(t.customer.user?t.customer.user.full_name:"user not in record"))+"\n                                ")])]),t._v(" "),a("tr",[a("th",{staticClass:"text-muted"},[a("i",{staticClass:"mr-3 far fa-building"}),t._v("Branch")]),t._v(" "),a("td",[t._v(t._s(t._f("capitalize")(t.branch)))])])])])])])]),t._v(" "),t.full?a("div",[t._v("Full profile goes here")]):t._e()]):t._e()],1)])},staticRenderFns:[]}},eKW8:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"[data-function=display].status[data-v-e7acf5bc]{border-top-right-radius:0;border-bottom-right-radius:0}.status.dropdown-toggle[data-v-e7acf5bc]{border-top-left-radius:0!important;border-bottom-left-radius:0!important;padding:1rem!important}.approved.dropdown-toggle[data-v-e7acf5bc]{background:-webkit-gradient(linear,left top,left bottom,from(#00a368),to(#00662a));background:linear-gradient(180deg,#00a368,#00662a)}.not-approved.dropdown-toggle[data-v-e7acf5bc]{background:-webkit-gradient(linear,left top,left bottom,from(#e12424),to(#a40000));background:linear-gradient(180deg,#e12424,#a40000)}.dropdown-toggle[data-v-e7acf5bc]:after{border-top:.6em solid;border-right:.6em solid transparent;border-left:.6em solid transparent}",""])},jyFz:function(t,e,a){var r=function(){return this}()||Function("return this")(),n=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,s=n&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,t.exports=a("SldL"),n)r.regeneratorRuntime=s;else try{delete r.regeneratorRuntime}catch(t){r.regeneratorRuntime=void 0}},m2tk:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Message=void 0;var r=function(){function t(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}}(),n=a("p/p5");e.Message=function(){function t(e,a){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.user_id=n,this.message=e,this.logToDB=r,this.contacts=a.split(",").filter(function(t){return/\S/.test(t)}).map(function(t){return"234"+t.trim().substr(1)}).join(","),this.setPages(),this.setContactCount()}return r(t,[{key:"setContactCount",value:function(){this.contact_count=this.contacts.split(",").length}},{key:"setPages",value:function(){this.pages=Math.ceil(this.message.length/160)}},{key:"send",value:function(t){var e=this;(0,n.get)("/api/message/create?to="+this.contacts+"&message="+this.message).then(function(a){return 200===a.status&&e.logToDB&&(delete e.logToDB,(0,n.post)("/api/message",e)),!!t&&t(a)}).catch(function(e){return!!t&&t(e)})}}]),t}()},oKx2:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{title:"",buttonTitle:null,to:null}}},pnqf:function(t,e,a){var r=a("eKW8");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a("rjj0")("d6c28a92",r,!0,{})},rN6N:function(t,e,a){"use strict";var r,n=function(){function t(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}}(),s=a("I3G/"),o=(r=s)&&r.__esModule?r:{default:r},i=a("N71M");function c(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var u=new o.default,d=function(){function t(e,a){l(this,t),this._order=e,this._customer=a,this._paymentBanks=[],this._paymentMethods=[],this._actualPayDates=[],this._actualAmountsPaid=[],this._amountsToBePaid=[],this._repaymentCaptions=[],this._paymentStatusClasses=[],this._repaymentLevel=0,this._amountPaid=null,this._discountAmount=null,this._outstandingDebt=null,this._discountedTotal=null,this._defaultFee=null,this._totalPlusDefault=null,this._payments={},this.setIsOrderFormal(),this.setIsRepaymentValid(),this.setRepaymentData(),this.setCountAndInterval(),this.setCommonDetails(),this.setDueDates(),this.setPaymentStatusClasses(),this.calcAndSetPaymentSummary(),this.setBranch(),this.setDiscount()}return n(t,[{key:"setIsRepaymentValid",value:function(){this._isRepaymentValid=!(!this.order.repayment_formal&&!this.order.repayment_informal)}},{key:"setIsOrderFormal",value:function(){this._isOrderFormal=["formal","salaried"].includes(this._customer.employment_status.toLowerCase()),4===parseInt(this.order.payment_method_id)&&(this._isOrderFormal=!0)}},{key:"setRepaymentData",value:function(){null!=this.order.repayment_formal&&(this._repaymentData=this.order.repayment_formal),null!=this.order.repayment_informal&&(this._repaymentData=this.order.repayment_informal)}},{key:"setCountAndInterval",value:function(){var e=void 0,a=void 0;new Date(this.order.order_date)<=new Date("2019-07-07")?(null!=this.order.repayment_formal&&(e=28,a=6),null!=this.order.repayment_informal&&(e=14,a=12)):t.isBankDraftAvailable()&&this.isOrderFormal||4===parseInt(this.order.payment_method_id)?(e=28,a=6):(e=14,a=12),this._count=a,this._interval=e}},{key:"setDueDates",value:function(){this._dueDates=t.generateDueDates(this.order.order_date,this.interval,this.count)}},{key:"setCommonDetails",value:function(){if(this.isRepaymentValid)for(var t=1;t<this.count+1;t++){for(var e=u.$getColumn(t).split(""),a=[],r=1;r<=2;r++)a.unshift(e.pop());this._repaymentCaptions.push("<td>"+e.join("")+"<sup>"+a.join("")+"</sup></td>"),this._actualPayDates.push(this.repaymentData[u.$getColumn(t)+"_date"]),this._actualAmountsPaid.push(this.repaymentData[u.$getColumn(t)+"_pay"]),this._paymentBanks.push(this.repaymentData[u.$getColumn(t)+"_payment_bank"]),this._paymentMethods.push(this.repaymentData[u.$getColumn(t)+"_payment_method"]),this._amountsToBePaid.push(u.$roundDownAmt(this.order.repayment_amount)),this.repaymentData[u.$getColumn(t)+"_pay"]>0&&this._repaymentLevel++}}},{key:"setBranch",value:function(){var t=this;this.order.store_product?this._branch=i.store.state.branches.find(function(e){return parseInt(e.id)===parseInt(t.order.store_product.store_name)}):this._branch=null}},{key:"setPaymentStatusClasses",value:function(){if(this.isRepaymentValid)for(var e=1;e<this.count+1;e++){var a={class:null,icon:null},r=u.$getColumn(e),n=t.isPaymentDue(this.dueDates[e-1]),s=parseInt(this.repaymentData[r+"_pay"]);s?(a.class="paid",a.icon="fa-check"):n&&!s?(a.class="missed",a.icon="fa-times"):n||(a.class="pending",a.icon="fa-hourglass-start"),this._paymentStatusClasses.push(a)}}},{key:"calcAndSetPaymentSummary",value:function(){var t=function(t){return u.$formatCurrency(t)},e=this.order,a=e.repayment_amount,r=e.down_payment,n=e.product_price,s=6===this.count?.5:1,o=this.order.discount.percentage_discount,i=o>0?5===o?1:2:0,c=u.$roundDownAmt(a*s*i);this._discountAmount=t(c);var l=0,d=0;if(this.repaymentData){for(var m=0;m<this.count+1;m++){var p=parseInt(this.actualAmountsPaid[m]);d+=p?u.$roundDownAmt(p):0}l=u.$roundDownAmt(parseInt(r))+d+c}this._amountPaid=t(l);var f=u.$roundDownAmt(n-c);this._discountedTotal=t(f);var v=0;new Date(this.order.order_date)>new Date("2019-07-07")&&(v=500*[].length),this._defaultFee=t(v),this._totalPlusDefault=t(f+v),this._outstandingDebt=t(u.$roundDownAmt(parseInt(n)-l))}},{key:"setDiscount",value:function(){this._discount=this.order.discount.name+" "+this.order.discount.percentage_discount}},{key:"payments",set:function(t){this._payments=t},get:function(){return this._payments}},{key:"repaymentLevel",get:function(){return this._repaymentLevel}},{key:"order",get:function(){return this._order}},{key:"customer",get:function(){return this._customer}},{key:"isRepaymentValid",get:function(){return this._isRepaymentValid}},{key:"isOrderFormal",get:function(){return this._isOrderFormal}},{key:"repaymentData",get:function(){return this._repaymentData}},{key:"count",get:function(){return this._count}},{key:"interval",get:function(){return this._interval}},{key:"dueDates",get:function(){return this._dueDates}},{key:"paymentStatusClasses",get:function(){return this._paymentStatusClasses}},{key:"repaymentCaptions",get:function(){return this._repaymentCaptions}},{key:"paymentBanks",get:function(){return this._paymentBanks}},{key:"paymentMethods",get:function(){return this._paymentMethods}},{key:"actualPayDates",get:function(){return this._actualPayDates}},{key:"actualAmountsPaid",get:function(){return this._actualAmountsPaid}},{key:"amountsToBePaid",get:function(){return this._amountsToBePaid}},{key:"amountPaid",get:function(){return this._amountPaid}},{key:"discountAmount",get:function(){return this._discountAmount}},{key:"outstandingDebt",get:function(){return this._outstandingDebt}},{key:"discountedTotal",get:function(){return this._discountedTotal}},{key:"defaultFee",get:function(){return this._defaultFee}},{key:"totalPlusDefault",get:function(){return this._totalPlusDefault}},{key:"branch",get:function(){return this._branch}},{key:"discount",get:function(){return this._discount}},{key:"customerName",get:function(){return this.customer.first_name+" "+this.customer.last_name}},{key:"customerWGName",get:function(){var t=this.customer;return t.work_guarantor_first_name+" "+t.work_guarantor_last_name+" - "+t.work_guarantor_relationship}},{key:"customerPGName",get:function(){var t=this.customer;return t.personal_guarantor_first_name+" "+t.personal_guarantor_last_name+" - "+t.personal_guarantor_relationship}}],[{key:"generateDueDates",value:function(t,e,a){for(var r=[],n=0;n<a;n++){var s=new Date(t).addDays((n+1)*e),o=u.$getDate(s);r.push(o)}return r}},{key:"isPaymentDue",value:function(t){return new Date>new Date(t)}},{key:"isBankDraftAvailable",value:function(){return!1}},{key:"renderMessage",value:function(t){return t.sms?t.sms.message.replace(/%0a/g,"</br>"):t.feedback}},{key:"convertToName",value:function(t,e){return t?i.store.state[e].find(function(e){return e.id===t}).name:null}}]),t}(),m=function(t){function e(t,a){l(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,t.customer));return r._isReminderSent=!1,r._dvaId=a,r._isSelected=!1,r.setReminder(null),r.setIsReminderSent(),r.setFinancialStatus(),r.setPromiseCall(),r.generateAndSetNextSMSReminder(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),n(e,[{key:"setIsReminderSent",value:function(){var t=this,e=u.$getDate();this.order.reminders.forEach(function(a){var r=a.date.split(" "),n=r[0].split("-"),s=r[1].split(":"),o=[].concat(c(n),c(s)).map(function(t){return parseInt(t,10)});u.$getDate(new Date(Date.UTC.apply(Date,c(o))),!1)===e&&(t._isReminderSent=!0)})}},{key:"setFinancialStatus",value:function(){this._financialStatus=this.isRepaymentValid?"Paid: "+this.amountPaid+" | Debt: "+this.outstandingDebt:"no detail!"}},{key:"generateAndSetNextSMSReminder",value:function(){var t=null;this.order.store_product&&(t=this.order.store_product.product_name);var e=this.order,a=e.repayment_amount,r=void 0;e.order_date===u.$getDate()?(r="Hello "+this.customerName+", thanks for patronizing us. The following is the breakdown of the repayment plan for the purchase of "+t+":%0a",this.dueDates.forEach(function(t,e){return r+=u.$getColumn(e+1)+": "+t+" => "+u.$formatCurrency(u.$roundDownAmt(a))+"%0a"})):r="Hello "+this.customerName+", This is to remind you that your "+u.$getColumn(parseInt(this.repaymentLevel)+1)+" repayment of "+u.$formatCurrency(u.$roundDownAmt(a))+" for "+t+" will be due on "+this.dueDates[this.repaymentLevel]+". we will be expecting you.",this._nextSMSReminder=r+"Please remember to pay on time to avoid late fees and other penalties.%0aThank you."}},{key:"setReminder",value:function(t){this._reminder={type:t,feedback:null,is_visited:null,dva_id:this.dvaId,order_id:this.order.id,customer_id:this.customer.id,canBeSelected:!this.isReminderSent,repayment_level:this.repaymentLevel+"/"+this.count},"sms"===t&&(this._reminder.sms_id=null,this._reminder.contacts=this.customer.telephone)}},{key:"setPromiseCall",value:function(){this._promiseCall={order_id:this.order.id,user_id:this.dvaId,customer_id:this.customer.id,date:null}}},{key:"isSelected",set:function(t){this._isSelected=t},get:function(){return this._isSelected}},{key:"isReminderSent",get:function(){return this._isReminderSent}},{key:"dvaId",get:function(){return this._dvaId}},{key:"financialStatus",get:function(){return this._financialStatus}},{key:"nextSMSReminder",get:function(){return this._nextSMSReminder}},{key:"reminder",get:function(){return this._reminder}},{key:"promiseCall",get:function(){return this._promiseCall}}]),e}();t.exports={Order:d,OrderWithPromiseCall:m}},reRT:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,".attendance-item[data-v-79933b66]{cursor:auto}",""])},rjj0:function(t,e,a){var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var n=a("tTVk"),s={},o=r&&(document.head||document.getElementsByTagName("head")[0]),i=null,c=0,l=!1,u=function(){},d=null,m="data-vue-ssr-id",p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(t){for(var e=0;e<t.length;e++){var a=t[e],r=s[a.id];if(r){r.refs++;for(var n=0;n<r.parts.length;n++)r.parts[n](a.parts[n]);for(;n<a.parts.length;n++)r.parts.push(h(a.parts[n]));r.parts.length>a.parts.length&&(r.parts.length=a.parts.length)}else{var o=[];for(n=0;n<a.parts.length;n++)o.push(h(a.parts[n]));s[a.id]={id:a.id,refs:1,parts:o}}}}function v(){var t=document.createElement("style");return t.type="text/css",o.appendChild(t),t}function h(t){var e,a,r=document.querySelector("style["+m+'~="'+t.id+'"]');if(r){if(l)return u;r.parentNode.removeChild(r)}if(p){var n=c++;r=i||(i=v()),e=g.bind(null,r,n,!1),a=g.bind(null,r,n,!0)}else r=v(),e=function(t,e){var a=e.css,r=e.media,n=e.sourceMap;r&&t.setAttribute("media",r);d.ssrId&&t.setAttribute(m,e.id);n&&(a+="\n/*# sourceURL="+n.sources[0]+" */",a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");if(t.styleSheet)t.styleSheet.cssText=a;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(a))}}.bind(null,r),a=function(){r.parentNode.removeChild(r)};return e(t),function(r){if(r){if(r.css===t.css&&r.media===t.media&&r.sourceMap===t.sourceMap)return;e(t=r)}else a()}}t.exports=function(t,e,a,r){l=a,d=r||{};var o=n(t,e);return f(o),function(e){for(var a=[],r=0;r<o.length;r++){var i=o[r];(c=s[i.id]).refs--,a.push(c)}e?f(o=n(t,e)):o=[];for(r=0;r<a.length;r++){var c;if(0===(c=a[r]).refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete s[c.id]}}}};var _,y=(_=[],function(t,e){return _[t]=e,_.filter(Boolean).join("\n")});function g(t,e,a,r){var n=a?"":r.css;if(t.styleSheet)t.styleSheet.cssText=y(e,n);else{var s=document.createTextNode(n),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(s,o[e]):t.appendChild(s)}}},tTVk:function(t,e){t.exports=function(t,e){for(var a=[],r={},n=0;n<e.length;n++){var s=e[n],o=s[0],i={id:t+":"+n,css:s[1],media:s[2],sourceMap:s[3]};r[o]?r[o].parts.push(i):a.push(r[o]={id:o,parts:[i]})}return a}},vRKz:function(t,e,a){var r=a("VU/8")(a("Or4O"),a("JqtT"),!1,function(t){a("pnqf")},"data-v-e7acf5bc",null);t.exports=r.exports},wBhk:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["pageTitle","pageTitleSmall","previous","forward"]}}});